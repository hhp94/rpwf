<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A R6 object that provides a common set of methods to 1) store the metadata of
data in the db, and 2) export parquet files for python to import. Not
meant to be called manually."><title>Internal R6 Object Only for Setting up Inheritance — BaseEx • rpwf</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Internal R6 Object Only for Setting up Inheritance — BaseEx"><meta property="og:description" content="A R6 object that provides a common set of methods to 1) store the metadata of
data in the db, and 2) export parquet files for python to import. Not
meant to be called manually."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rpwf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/rpwf.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/python_codes.html">Python Codes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Internal R6 Object Only for Setting up Inheritance</h1>
      
      <div class="d-none name"><code>BaseEx.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A R6 object that provides a common set of methods to 1) store the metadata of
data in the db, and 2) export parquet files for python to import. Not
meant to be called manually.</p>
    </div>


    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>hash</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
hash of the object by <code><a href="https://rlang.r-lib.org/reference/hash.html" class="external-link">rlang::hash()</a></code>.</p></dd>


<dt><code>pin_name</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
pin_name of the file in the project folder.</p></dd>


<dt><code>df</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code>)<br>
the df for the hyper param grid or the transformed df.</p></dd>


<dt><code>con</code></dt>
<dd><p>(<code><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">DBI::dbConnect()</a></code>)<br>
a <code><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">DBI::dbConnect()</a></code> object, generated by <code><a href="rpwf_connect_db.html">rpwf_connect_db()</a></code>.</p></dd>


<dt><code>export_query</code></dt>
<dd><p>(<code><a href="https://glue.tidyverse.org/reference/glue_sql.html" class="external-link">glue::glue_sql()</a></code>)<br>
SQL query to upload metadata of the data into the db.</p></dd>


<dt><code>queried_pin_name</code></dt>
<dd><p>(<code><a href="https://glue.tidyverse.org/reference/glue_sql.html" class="external-link">glue::glue_sql()</a></code>)<br>
Queried pin_name of the object.</p></dd>


<dt><code>board</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
a <code>{pins}</code> board object.</p></dd>


<dt><code>dbname</code></dt>
<dd><p>name of the database.</p></dd>


<dt><code>seed</code></dt>
<dd><p>random seed.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-BaseEx-new"><code>BaseEx$new()</code></a></p></li>
<li><p><a href="#method-BaseEx-exec_query"><code>BaseEx$exec_query()</code></a></p></li>
<li><p><a href="#method-BaseEx-set_hash"><code>BaseEx$set_hash()</code></a></p></li>
<li><p><a href="#method-BaseEx-set_pin_name"><code>BaseEx$set_pin_name()</code></a></p></li>
<li><p><a href="#method-BaseEx-find_pin_name_in_db"><code>BaseEx$find_pin_name_in_db()</code></a></p></li>
<li><p><a href="#method-BaseEx-set_export_query"><code>BaseEx$set_export_query()</code></a></p></li>
<li><p><a href="#method-BaseEx-set_df"><code>BaseEx$set_df()</code></a></p></li>
<li><p><a href="#method-BaseEx-export_prep"><code>BaseEx$export_prep()</code></a></p></li>
<li><p><a href="#method-BaseEx-export_db"><code>BaseEx$export_db()</code></a></p></li>
<li><p><a href="#method-BaseEx-export_parquet"><code>BaseEx$export_parquet()</code></a></p></li>
<li><p><a href="#method-BaseEx-export"><code>BaseEx$export()</code></a></p></li>
<li><p><a href="#method-BaseEx-clone"><code>BaseEx$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-BaseEx-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>This class is the parent of RGrid and TrainDf R6 object, not meant to be
called.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/BaseEx.html">BaseEx</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">db_con</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>db_con</code></dt>
<dd><p>(<code>DbCon</code>)<br>
a <code>DbCon</code> object, generated by <code><a href="rpwf_connect_db.html">rpwf_connect_db()</a></code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-BaseEx-exec_query"></a><div class="section">
<h3 id="method-exec-query-">Method <code>exec_query()</code><a class="anchor" aria-label="anchor" href="#method-exec-query-"></a></h3>
<p>Run the query that check if the object exists in the db by checking the
hash of the object in the db. Either find one unique row or no row.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">BaseEx</span><span class="op">$</span><span class="fu">exec_query</span><span class="op">(</span><span class="va">query</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>query</code></dt>
<dd><p>(<code><a href="https://glue.tidyverse.org/reference/glue_sql.html" class="external-link">glue::glue_sql()</a></code>)<br>
SQL query for either the hyper parameter grid or the transformed df.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-BaseEx-set_hash"></a><div class="section">
<h3 id="method-set-hash-">Method <code>set_hash()</code><a class="anchor" aria-label="anchor" href="#method-set-hash-"></a></h3>
<p>Pass the hash of the object to this function to set the hash attribute.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">BaseEx</span><span class="op">$</span><span class="fu">set_hash</span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>val</code></dt>
<dd><p>(<code>any</code>)<br>
New hash, either an integer or string.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-BaseEx-set_pin_name"></a><div class="section">
<h3 id="method-set-pin-name-">Method <code>set_pin_name()</code><a class="anchor" aria-label="anchor" href="#method-set-pin-name-"></a></h3>
<p>Change the pin_name where the object is stored. Is NA only when no grid is
provided. Have to provide a train data.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">BaseEx</span><span class="op">$</span><span class="fu">set_pin_name</span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>val</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
Path to store the object on disk.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-BaseEx-find_pin_name_in_db"></a><div class="section">
<h3 id="method-find-pin-name-in-db-">Method <code>find_pin_name_in_db()</code><a class="anchor" aria-label="anchor" href="#method-find-pin-name-in-db-"></a></h3>
<p>Store the results of the query from the db in a data.frame. Query have to
return a df (so <code><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow()</a></code> works) with 0 &lt;= <code><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow()</a></code> &lt; 2.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">BaseEx</span><span class="op">$</span><span class="fu">find_pin_name_in_db</span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>val</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code>)<br>
New data frame generated by <code>self$exec_query</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-BaseEx-set_export_query"></a><div class="section">
<h3 id="method-set-export-query-">Method <code>set_export_query()</code><a class="anchor" aria-label="anchor" href="#method-set-export-query-"></a></h3>
<p>Change the SQL query to export metadata to database.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">BaseEx</span><span class="op">$</span><span class="fu">set_export_query</span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>val</code></dt>
<dd><p>(<code><a href="https://glue.tidyverse.org/reference/glue_sql.html" class="external-link">glue::glue_sql()</a></code>)<br>
New SQL query to export metadata.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-BaseEx-set_df"></a><div class="section">
<h3 id="method-set-df-">Method <code>set_df()</code><a class="anchor" aria-label="anchor" href="#method-set-df-"></a></h3>
<p>If the hash of the new object is not found in the database, then new
data is prepared. If the data is found in the metadata but not in the
indicated pin_name then new data is also prepared. Otherwise, <code>self$df</code> is
NULL and will be skipped by the <code>BaseEx::self$export_parquet()</code> method.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">BaseEx</span><span class="op">$</span><span class="fu">set_df</span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>val</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code>)<br>
Either a <code><a href="https://recipes.tidymodels.org/reference/juice.html" class="external-link">recipes::juice()</a></code> object or a data.frame of the hyper param grid.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-BaseEx-export_prep"></a><div class="section">
<h3 id="method-export-prep-">Method <code>export_prep()</code><a class="anchor" aria-label="anchor" href="#method-export-prep-"></a></h3>
<p>If the db query found no existing metadata, then an export pin_name is made.
If the metadata is found but the associated data is not found, then an
export pin_name is also made. Else get the pin_name from the metadata in the db.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">BaseEx</span><span class="op">$</span><span class="fu">export_prep</span><span class="op">(</span><span class="va">new_pin_name</span>, <span class="va">new_export_query</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>new_pin_name</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
Path to the object.</p></dd>


<dt><code>new_export_query</code></dt>
<dd><p>(<code><a href="https://glue.tidyverse.org/reference/glue_sql.html" class="external-link">glue::glue_sql()</a></code>)<br>
SQL query to export the obj metadata to the db.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-BaseEx-export_db"></a><div class="section">
<h3 id="method-export-db-">Method <code>export_db()</code><a class="anchor" aria-label="anchor" href="#method-export-db-"></a></h3>
<p>If the <code>self$export_query</code> is generated because metadata is not found in
the database, then export the metadata to the db using this query.
Otherwise return NULL.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">BaseEx</span><span class="op">$</span><span class="fu">export_db</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-BaseEx-export_parquet"></a><div class="section">
<h3 id="method-export-parquet-">Method <code>export_parquet()</code><a class="anchor" aria-label="anchor" href="#method-export-parquet-"></a></h3>
<p>If the file specified by <code>self$pin_name</code> is not found, then export the file
as a parquet file to the location specified in the metadata.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">BaseEx</span><span class="op">$</span><span class="fu">export_parquet</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-BaseEx-export"></a><div class="section">
<h3 id="method-export-">Method <code>export()</code><a class="anchor" aria-label="anchor" href="#method-export-"></a></h3>
<p>Wrapper around exporting information to the db and writing the parquet
file.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">BaseEx</span><span class="op">$</span><span class="fu">export</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-BaseEx-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">BaseEx</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Hung Pham.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

